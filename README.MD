## HH Resume Notes & Colors (Tampermonkey)

### Назначение
**HH Resume Notes & Colors** — пользовательский скрипт для Tampermonkey, который:
- **добавляет комментарий** к каждому резюме на странице «Мои резюме» на hh.ru;
- **добавляет цветовую метку** (полоску слева у карточки резюме);
- **сохраняет комментарий и цвет в `localStorage` сайта** по `data-qa-id` резюме, чтобы они не терялись при перезагрузке.

### Целевая страница
Скрипт рассчитан на страницу списка резюме пользователя на hh.ru, где каждая карточка резюме имеет вид:
- корневой элемент карточки с атрибутом `data-qa="resume resume-highlighted"`;
- уникальный идентификатор резюме в атрибуте `data-qa-id="..."`.

### Локальное хранилище
Все данные хранятся в `window.localStorage` под ключом:
- **`hh-resume-notes-and-colors`**

Структура данных:
- объект, где **ключ** — это `data-qa-id` резюме, **значение** — объект:
  - `comment: string` — текст комментария;
  - `color: string` — выбранный цвет в формате HEX (например `#ffd966`).

Пример хранилища:
```json
{
  "263776392": {
    "comment": "Основное резюме, откликаться в первую очередь",
    "color": "#54d487"
  },
  "263417999": {
    "comment": "Под проекты с Node.js",
    "color": "#ffd966"
  }
}
```

### Как скрипт работает

#### Поиск карточек резюме
- При загрузке страницы выполняется функция `setup()`.
- Ищутся все элементы:
  - селектор: `[data-qa="resume resume-highlighted"][data-qa-id]`.
- Для каждой найденной карточки вызывается инициализация.

#### Инициализация карточки (`initForCard`)
Для каждого резюме по его `data-qa-id` скрипт:
1. **Читает состояние** из `localStorage` (комментарий и цвет).
2. **Создаёт панель** под карточкой резюме:
   - заголовок «Моя пометка»;
   - палитра преднастроенных цветов + выбор своего цвета;
   - поле `textarea` для комментария.
3. **Навешивает обработчики**:
   - при изменении текста или цвета вызывается `onChange`, данные сохраняются в `localStorage`.
4. **Применяет цвет** к карточке:
   - слева создаётся вертикальная цветная полоска (если цвет выбран);
   - если у карточки `position: static`, ей выставляется `position: relative`.

#### Панель комментария
Панель создаётся функцией `createPanel` и:
- содержит кнопки быстрого выбора цветов;
- позволяет сбросить цвет (прозрачный) или выбрать кастомный;
- вставляется в конец карточки.

#### Цветовая метка
Цветовая метка создаётся функцией `applyColorToCard`:
- узкая вертикальная полоса слева у карточки;
- цвет берётся из выбранного, по умолчанию `transparent` (нет цвета);
- полоса не мешает кликам по карточке.

#### Поддержка динамической подгрузки
- Используется `MutationObserver` на `document.body` с опциями `{ childList: true, subtree: true }`.
- При добавлении новых узлов на страницу:
  - если добавленный узел — карточка резюме, она сразу инициализируется;
  - если внутри добавленного узла есть карточки по селектору `[data-qa="resume resume-highlighted"][data-qa-id]`, они тоже инициализируются.
- При появлении новых карточек состояние также сохраняется в `localStorage`.

### Как установить скрипт
1. Установить расширение **Tampermonkey** в браузер.
2. Создать новый скрипт и вставить содержимое файла `hh-tamper.user.js`.
3. Убедиться, что в шапке скрипта указаны нужные `@match` для страницы резюме, например:
   - `*://*.hh.ru/applicant/resumes`
4. Сохранить скрипт.

### Как пользоваться
1. Открыть страницу «Мои резюме» на hh.ru.
2. Под каждой карточкой резюме появится блок:
   - палитра цветов (пресеты + свой цвет);
   - поле для ввода **комментария**.
3. Введённый комментарий и выбранный цвет:
   - **автоматически сохраняются** в `localStorage` по `data-qa-id` резюме;
   - **восстанавливаются** при следующем открытии страницы;
   - **всегда видимы** (и цветовая полоска, и текст комментария).
